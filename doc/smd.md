一句话来描述就是：单机版的Redis

 

从事网络游戏后端开发十多年，一直都是在做有状态的服务，我们的做事逻辑是，玩家上线、加载玩家存档，玩家一边玩游戏，我们一边修改数据，最后玩家下线，存档，完毕。就是这样一个过程。

 

做着做着，我们发现一个情况，对于一些关系数据（比如工会、好友等）需要在服务器启动的时候加载到内存中，加载完毕玩家才能上线，要不然在玩家上线的时候去加载可能会卡一下。一方面增加了服务器的负担，一方面影响了玩家的体验。如果这些数据量比较大，达到几个G，加载过程可能会持续几分钟。也就意味着如果我们更新版本的时候，这段时间是处于停服状态。

 

现在我们就在想，如果上线之后发现问题，然后更新版本，每次都这么久，玩家不乐意了，如何解决这个问题呢？

 

有几种做法，一个是使用redis存储这些关系数据，服务器启动的时候redis不用重启。另外一种是使用共享内存。

 

使用Redis存储关系数据我一开始是拒绝的，因为数据没在本地，在远端，要通过tcp网络传输，如果使用同步方式性能比较差，如果使用异步方式编程很麻烦。要特别注意时序问题。

 

共享内存貌似没有封装的比较好用的接口，至少我目前还没找到，如果你有麻烦推荐给我。

对于共享内存的封装方式，目前业界还是有蛮多的，直到今天我听华杉讲营销的时候他主张，要让接受成本最低。我就突然想到了用Redis的方式封装共享内存。于是就有了这个：

 

 

Share Memory Dictionary

 

基本特性：

1. API类似Redis接口。会用Redis的人能迅速上手。

2. 数据存入共享内存，进程没了数据还在。

3. 跨平台，Windows、Linux均可用。

4. 全头文件，拷贝即可使用。

 

 